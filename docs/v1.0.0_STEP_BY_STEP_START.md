# LLMscope v1.0.0 – Step-by-Step Start (Working Draft)

Goal: Refactor to v1.0.0 while leaving v0.2.x untouched. Focus on stability, performance, and P0 dashboard gaps before advanced features.

Last updated: 2025-10-31

---

## Ground rules

- Keep v0.2.x behavior intact. No breaking changes to current users.
- Work on a dedicated branch and feature flags where needed.
- Each step has clear acceptance criteria and test notes.

Suggested branch: `v2-refactor` (goal release: v1.0.0)

---

## Phase 0 – Immediate P0 fixes (from ROADMAP_v5)

1. Enhanced Telemetry in UI (System Status)

- Add Ollama metrics: total_duration, eval_duration, prompt_eval, eval_count, tokens/sec
- Wire backend → frontend state; ensure null-safe rendering
- Acceptance: Metrics visible; no console errors; values match backend JSON
- Tests: Snapshot UI test; one integration call verifying fields render

1. Copilot prompt includes cognitive metrics

- Update backend prompts to add telemetry context to explanations
- Preserve three modes: Technical, Business, Remediation
- Acceptance: Copilot mentions cognitive load where relevant
- Tests: Prompt unit test (string contains), golden output sanity

1. Professional case reports

- Add server endpoint to generate case report for a violation id
- Report template: Symptoms, Context, Diagnosis, Remediation, Outcome, Next steps
- Export: Markdown + downloadable PDF (nice-to-have)
- Acceptance: One-click report download from violation modal
- Tests: Template rendering test; endpoint returns 200 and well-formed MD

1. Zoomed Chart (±15 minutes around violation)

- Fix prop types, error boundaries, memoization; re-enable component
- Acceptance: No crashes; smooth interaction; correct time window
- Tests: Rendering test with mocked data slice

---

## Phase 1 – Security, performance, and stability

1. Memory leak fix in Dashboard_ollama_revB.jsx

- Remove fetchSPC from useEffect deps; verify cleanup
- Acceptance: Memory steady after 30 minutes
- Tests: Basic render + unmount leak check

1. Remove hardcoded API keys / secrets

- Ensure no fallback keys; config via env or settings UI
- Acceptance: Repo scan shows no secrets; app loads with env vars
- Tests: Lint grep; settings load test

1. DB indexes + connection pooling

- Add indexes in init_db(); introduce pooling for concurrent load
- Acceptance: P95 query latency improves; no connection thrash
- Tests: Simple perf harness; unit tests for pool limits

1. Input validation + rate limiting

- Pydantic models for request bodies; slowapi for rate limits
- Acceptance: Invalid input returns 422; abusive clients get 429
- Tests: Negative API tests; rate limit counter test

---

## Phase 2 – Advanced detection and integrations

1. Nelson Rules R4–R8

- Implement R4–R8 server-side; feature-flagged
- Acceptance: Deterministic unit tests per rule; toggle-able
- Tests: Rule test vectors; regression for R1–R3 unchanged

1. Integrations

- Prometheus `/metrics` endpoint; Grafana dashboard JSON
- Webhooks: Generic POST; PagerDuty (optional)
- Acceptance: Metrics scrape OK; sample Grafana dashboard renders
- Tests: Scrape response shape; webhook contract test

1. Custom alert configuration

- Per-rule toggles and thresholds; model-specific overrides
- Acceptance: Settings persist; alerts follow overrides
- Tests: Settings schema + behavior tests

---

## Developer experience and release

1. Error boundaries + logging

- React error boundaries; structured backend logs
- Acceptance: UI degrades gracefully; logs have correlation ids

1. Docker & Compose refresh

- Confirm images build on Windows/macOS/Linux; healthchecks in compose
- Acceptance: `docker compose up` stable; health OK

1. Docs and examples

- Update READMEs, architecture guide, API docs; add 1–2 case studies
- Acceptance: New users set up in < 30 minutes

1. Versioning and changelog

- Bump to v1.0.0; thorough CHANGELOG; migration notes if any

---

## Notes & assumptions

- "Visual roadmap" refers to `docs/ROADMAP_v5.md` P0 checklist and Phase 3 scope
- We retain SQLite first; Postgres/Timescale remain Phase 4+
- All new features behind flags to protect v0.2.x

---

## Minimal tracking checklist

- [ ] P0 telemetry UI
- [ ] Copilot prompt update
- [ ] Case report endpoint
- [ ] Zoomed chart fix
- [ ] Memory leak fix
- [ ] Secrets audit
- [ ] DB indexes + pooling
- [ ] Validation + rate limiting
- [ ] R4–R8 rules
- [ ] Prometheus + Grafana
- [ ] Webhooks / PagerDuty
- [ ] Error boundaries + logging
- [ ] Compose refresh
- [ ] Docs + examples
- [ ] Version + changelog
